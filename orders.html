<!-- frontend/orders.html -->
<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>My Orders - Foodify</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header><div class="brand">Foodify</div></header>
  <main class="container">
    <h2>My Orders</h2>
    <div id="ordersList"></div>
    <div id="msg"></div>
  </main>

  <script>
    const API = 'http://localhost:5000/api';
    async function loadOrders() {
      const token = localStorage.getItem('token');
      if (!token) { alert('Please login first'); window.location.href = 'login.html'; return; }
      const res = await fetch(`${API}/orders/my`, { headers: { Authorization: `Bearer ${token}` } });
      const data = await res.json();
      if (!res.ok) { document.getElementById('msg').innerText = data.message || 'Could not load orders'; return; }
      const list = document.getElementById('ordersList');
      list.innerHTML = '';
      if (data.length === 0) list.innerHTML = '<p>No orders yet.</p>';
      data.forEach(o => {
        const div = document.createElement('div');
        div.className = 'order-card';
        const cartHTML = (o.cart_json ? JSON.parse(o.cart_json) : o.cart).map(i => `<div>${i.name || i.title} x ${i.qty || i.quantity}</div>`).join('');
        div.innerHTML = `
          <h3>Order #${o.id} - ${o.status || 'Pending'}</h3>
          <div>${cartHTML}</div>
          <div>Total: â‚¹${o.total}</div>
          <hr/>
        `;
        list.appendChild(div);
      });
    }
    loadOrders();
  </script>
</body>
</html>
